<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Campus Bite ‚Äì Meals & Budget</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:"Poppins", sans-serif; }
  body { background:#fff8f1; color:#333; }
  header { background:#ff914d; color:#fff; padding:20px 20px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 8px rgba(0,0,0,0.1);}
  header h1 { font-size:1.3rem; font-weight:600; }
  header button { background:#fff; color:#ff914d; border:none; border-radius:8px; padding:8px 16px; cursor:pointer; font-weight:600; transition:0.3s; }
  header button:hover{ background:#ffd6ba; }
  .filter-section { padding:15px 20px; }
  .filter-section label { margin-right:10px; font-weight:600; }
  #categoryFilter { padding:5px 8px; border-radius:5px; }
  .meal-section { padding:20px; display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; }
  .meal-card { background:#fff; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); overflow:hidden; transition:0.3s; }
  .meal-card:hover { transform:scale(1.03); }
  .meal-card img { width:100%; height:150px; object-fit:cover; }
  .meal-info { padding:12px; }
  .meal-info h3 { color:#ff6a00; margin-bottom:5px; font-size:1rem; }
  .meal-info p { font-size:0.85rem; margin-bottom:6px; }
  .meal-info button { background:#ff914d; color:#fff; border:none; border-radius:6px; padding:6px 10px; cursor:pointer; transition:0.3s; font-size:0.85rem;}
  .meal-info button:hover{ background:#ff6a00; }
  .budget-section { background:#fff0e6; padding:20px; text-align:center; border-top:3px solid #ff914d; margin-top:20px; }
  .budget-section h2 { color:#ff6a00; margin-bottom:8px; }
  .budget-section p { font-size:1rem; margin-bottom:8px; }
  .budget-section button { background:#ff914d; color:#fff; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; transition:0.3s; font-size:0.9rem; }
  .budget-section button:hover{ background:#ff6a00; }
  footer { text-align:center; padding:15px; font-size:0.9rem; background:#fff8f1; color:#777; margin-top:20px; }
  @media (max-width:600px) { .meal-section { grid-template-columns:repeat(2,1fr); } }
</style>
</head>
<body>

<header>
 <div>
  <h1 id="welcomeUser">Welcome to Campus Bite üçΩÔ∏è</h1>
  <p class="subtitle">Plan your meals, save your budget.</p>
 </div>
 <button id="logoutBtn">Logout</button>
</header>

<section class="filter-section">
  <label for="categoryFilter">Show:</label>
  <select id="categoryFilter">
    <option value="All">All</option>
    <option value="Breakfast">Breakfast</option>
    <option value="Lunch">Lunch</option>
    <option value="Drink">Drinks</option>
  </select>
</section>

<section class="meal-section" id="mealSection">
  <!-- Meals rendered here -->
</section>

<section class="budget-section">
  <h2>Your Daily Budget</h2>
  <p id="budgetTotal">UGX 0</p>
  <button onclick="resetBudget()">Reset Budget</button>
  <button onclick="viewBudget()">View Added Items</button>
</section>

<footer>¬© 2025 Campus Bite. All rights reserved.</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyATGWLqyjWJUaDXwudubIc_Hvh5yPVDyOI",
    authDomain: "campus-bite-9dbaa.firebaseapp.com",
    projectId: "campus-bite-9dbaa",
    storageBucket: "campus-bite-9dbaa.firebasestorage.app",
    messagingSenderId: "294389261625",
    appId: "1:294389261625:web:095d6e5f85f4e8"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  let totalBudget = 0;
  let addedMeals = [];

  auth.onAuthStateChanged(user=>{
    if(!user) window.location.href="index.html";
    else {
      db.collection("students").doc(user.uid).get().then(doc=>{
        if(doc.exists){
          const data = doc.data();
          document.getElementById("welcomeUser").textContent = `Welcome, ${data.name} üçΩÔ∏è`;
        }
      });
    }
  });

  document.getElementById("logoutBtn").addEventListener("click", async ()=>{
    await auth.signOut();
    window.location.href="index.html";
  });

  // Meals array ‚Äî using local images
  const meals = [
    // üç≥ Breakfast (10)
    {name:"Mandazi", category:"Breakfast", place:"Campus Canteen", price:500, img:"images/mandazi.png"},
    {name:"Chapati", category:"Breakfast", place:"Campus Canteen", price:500, img:"images/chapati.jpg"},
    {name:"Fried Cassava", category:"Breakfast", place:"Cassava Lady", price:100, img:"images/fried cassava.jpg"},
    {name:"Pan Cakes", category:"Breakfast", place:"Cassava Lady", price:100, img:"pancakes.png"},
    {name:"Bagel with Cream Cheese", category:"Breakfast", place:"Campus Bakery", price:3000, img:"images/breakfast/bagel.jpg"},
    {name:"Smoothie Bowl", category:"Breakfast", place:"Fresh Spot", price:6000, img:"images/breakfast/smoothie.jpg"},
    {name:"Cereal & Milk", category:"Breakfast", place:"Student Lounge", price:2500, img:"images/breakfast/cereal.jpg"},
    {name:"Fried Eggs & Toast", category:"Breakfast", place:"Caf√© Bliss", price:4000, img:"images/breakfast/eggs.jpg"},
    {name:"Breakfast Burrito", category:"Breakfast", place:"Taste Hub", price:5500, img:"images/breakfast/burrito.jpg"},
    {name:"Waffles", category:"Breakfast", place:"Morning Caf√©", price:5000, img:"images/breakfast/waffles.jpg"},

    // üçõ Lunch (15)
    {name:"Kikomando", category:"Lunch", place:"Campus Canteen", price:1000, img:"images/kikomando.jpg"},
    {name:"Fried Rice", category:"Lunch", place:"Desert breeze", price:2000, img:"images/rice.webp"},
    {name:"Matooke", category:"Lunch", place:"Cassava Lady", price:2000, img:"images/matooke.jpg"},
    {name:"White Rice & Beans", category:"Lunch", place:"Cassava Lady", price:2000, img:"images/white rice.jpg"},
    {name:"Fish & Chips", category:"Lunch", place:"Food Court", price:12000, img:"images/lunch/fish.jpg"},
    {name:"Burger Combo", category:"Lunch", place:"Campus Diner", price:10000, img:"images/lunch/burger.jpg"},
    {name:"Chicken Wrap", category:"Lunch", place:"Food Express", price:7000, img:"images/lunch/wrap.jpg"},
    {name:"Veggie Sandwich", category:"Lunch", place:"Fresh Spot", price:6500, img:"images/lunch/sandwich.jpg"},
    {name:"Grilled Fish", category:"Lunch", place:"Caf√© Bliss", price:13000, img:"images/lunch/grilledfish.jpg"},
    {name:"Chicken Salad", category:"Lunch", place:"Green Bowl", price:8000, img:"images/lunch/salad.jpg"},
    {name:"Pizza Slice", category:"Lunch", place:"Pizza Stop", price:5000, img:"images/lunch/pizza.jpg"},
    {name:"Beef Tacos", category:"Lunch", place:"Food Truck", price:9000, img:"images/lunch/tacos.jpg"},
    {name:"Chicken Biryani", category:"Lunch", place:"Campus Kitchen", price:11000, img:"images/lunch/biryani.jpg"},
    {name:"Veggie Rice Bowl", category:"Lunch", place:"Green Bowl", price:7500, img:"images/lunch/ricebowl.jpg"},
    {name:"Beef Burger", category:"Lunch", place:"Food Court", price:10000, img:"images/lunch/beefburger.jpg"},

    // ü•§ Drinks (7)
    {name:"Cold Water", category:"Drink", place:"Campus Canteen", price:500, img:"images/nivana.jpg"},
    {name:"Cold sodas", category:"Drink", place:"Campus Canteen", price:1000, img:"images/soda.jpg"},
    {name:"Bongo", category:"Drink", place:"Campus Canteen", price:1000, img:"images/bongo.jpg"},
    {name:"Guiness", category:"Drink", place:"Campus Ark", price:4500, img:"images/guiness.png"},
    {name:"Bond 7", category:"Drink", place:"Campus Ark", price:7500, img:"images/bond7.jpg"},
    {name:"Smirnoff", category:"Drink", place:"Campus Ark", price:4000, img:"images/smirnoff.jpg"},
    {name:"Club Pilsener", category:"Drink", place:"Campus Ark", price:3500, img:"images/club.webp"},
    {name:"Juice", category:"Drink", place:"Campus Ark", price:2500, img:"images/minute maid.webp"},
    {name:"Bushera", category:"Drink", place:"Campus Canteen", price:1000, img:"images/bushera.jpeg"}
  ];

  const mealSection = document.getElementById("mealSection");
  const categoryFilter = document.getElementById("categoryFilter");

  function renderMeals(filter="All"){
    mealSection.innerHTML="";
    meals.filter(m=>filter==="All"||m.category===filter).forEach(meal=>{
      const card = document.createElement("div");
      card.className="meal-card";
      card.innerHTML=`
        <img src="${meal.img}" alt="${meal.name}">
        <div class="meal-info">
          <h3>${meal.name}</h3>
          <p>${meal.category} ‚Äì UGX ${meal.price.toLocaleString()}</p>
          <p><strong>Place:</strong> ${meal.place}</p>
          <button onclick="addToBudget('${meal.name}', ${meal.price})">Add to Budget</button>
        </div>
      `;
      mealSection.appendChild(card);
    });
  }

  categoryFilter.addEventListener("change", ()=>renderMeals(categoryFilter.value));

  const budgetDisplay = document.getElementById("budgetTotal");
  function addToBudget(name, amount){
    totalBudget+=amount;
    addedMeals.push({name, amount});
    budgetDisplay.textContent = "UGX "+totalBudget.toLocaleString();
    alert(`${name} added to your budget!`);
  }
  function resetBudget(){ totalBudget=0; addedMeals=[]; budgetDisplay.textContent="UGX 0"; }
  function viewBudget(){
    if(addedMeals.length===0) return alert("No items added yet!");
    let summary = "Your Daily Budget:\n\n";
    addedMeals.forEach(i=> summary+=`${i.name} - UGX ${i.amount}\n`);
    summary += `\nTotal: UGX ${totalBudget.toLocaleString()}`;
    alert(summary);
  }

  renderMeals();
</script>

</body>
</html>
